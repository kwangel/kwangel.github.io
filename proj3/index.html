<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Katie's CS180 Project 3</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        body {
            font-family: 'Quicksand', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #fff0f6;
            color: #333;
        }

        header {
            background: linear-gradient(to right, #ffb6c1, #ffc0cb, #ff69b4);
            padding: 30px 20px;
            text-align: center;
            color: white;
            border-bottom: 4px solid #ff85a2;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            margin: 0;
            font-size: 2.5em;
        }

        .content {
            padding: 30px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .question-section {
            background: white;
            margin: 30px 0;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: left;
        }

        .question-header {
            background: linear-gradient(to right, #ffb6c1, #ffc0cb);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
        }

        .question-header h2 {
            margin: 0;
            font-size: 1.8em;
        }

        .image-container {
            max-width: 100%;
            overflow: auto;
            text-align: center;
            margin: 20px 0;
        }

        .image-container img {
            max-width: 80%;
            height: auto;
            display: block;
            margin: 0 auto;
        }

        .images-row.mosaic .image-container img {
            max-width: 50%;
        }

        .image-caption {
            font-style: italic;
            color: #666;
            margin-top: 10px;
            font-size: 0.9em;
        }

        a {
            display: inline-block;
            margin-top: 20px;
            text-decoration: none;
            background: #ff85a2;
            color: white;
            padding: 12px 24px;
            border-radius: 25px;
            transition: background 0.3s ease;
            font-weight: 600;
        }

        a:hover {
            background: #ff5e88;
        }

        .images-row {
            display: flex;
            justify-content: space-evenly;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }

        .back-link {
            text-align: center;
            margin-top: 40px;
        }

        .explanation {
            margin-bottom: 20px;
            font-size: 1.05em;
            line-height: 1.6em;
            text-align: center;
        }
        pre.matrix {
            display: table;
            margin: 0 auto;
            text-align: left;
        }
    </style>
</head>
<body>

    <header>
        <h1>CS180 Project 3</h1>
    </header>

    <div class="content">
        
        <div class="question-section">
            <div class="question-header">
                <h2>A.1: Shoot the Pictures</h2>
            </div>
            <p class="explanation">
                Here are my three sets of images!
            </p>
            <div class="images-row">
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9131.jpg" alt="Set 1 - Left">
                    <div class="image-caption">Set 1 ‚Äî Left view</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9132.jpg" alt="Set 1 - Right">
                    <div class="image-caption">Set 1 ‚Äî Right view</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9140.jpg" alt="Set 2 - Left">
                    <div class="image-caption">Set 2 ‚Äî Left view</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9141.jpg" alt="Set 2 - Right">
                    <div class="image-caption">Set 2 ‚Äî Right view</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9153.jpg" alt="Set 2 - Left">
                    <div class="image-caption">Set 3 ‚Äî Left view</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9154.jpg" alt="Set 2 - Right">
                    <div class="image-caption">Set 3 ‚Äî Right view</div>
                </div>
            </div>
        </div>

        <div class="question-section">
            <div class="question-header">
                <h2>A.2: Recover Homographies</h2>
            </div>
            <p class="explanation">
                Following last week's discussion, I set up the system of equations for estimating the homography matrix in the standard linear form Ah = b. For each pair of corresponding points (x, y) in the first image and (u, v) in the second, I added two equations: one describing how (x, y) maps to u, and another describing how it maps to v. Each pair contributes two rows to the matrix A and two entries to the vector b. After constructing all these equations, I solved for the homography parameters h that best satisfy this system using least-squares.
                <br><br>
                In compact form for a single correspondence (x, y) ‚Üí (u, v):
                \[
                \begin{bmatrix}
                x & y & 1 & 0 & 0 & 0 & -u x & -u y \\
                0 & 0 & 0 & x & y & 1 & -v x & -v y
                \end{bmatrix}
                \begin{bmatrix}
                h_{1} \\ h_{2} \\ h_{3} \\ h_{4} \\ h_{5} \\ h_{6} \\ h_{7} \\ h_{8}
                \end{bmatrix}
                =
                \begin{bmatrix}
                u \\ v
                \end{bmatrix}
                \]
                For n correspondences, we can stack these rows:
                \[
                A = \begin{bmatrix}
                x_1 & y_1 & 1 & 0 & 0 & 0 & -u_1 x_1 & -u_1 y_1 \\
                0 & 0 & 0 & x_1 & y_1 & 1 & -v_1 x_1 & -v_1 y_1 \\
                \vdots & & & & & & & \vdots \\
                x_n & y_n & 1 & 0 & 0 & 0 & -u_n x_n & -u_n y_n \\
                0 & 0 & 0 & x_n & y_n & 1 & -v_n x_n & -v_n y_n
                \end{bmatrix},\quad
                b = \begin{bmatrix}
                u_1 \\ v_1 \\ \vdots \\ u_n \\ v_n
                \end{bmatrix}
                \]
                <br><br>
                The resulting homography matrix for the image pair below was:
                
                \[
                H = \begin{bmatrix}
                0.5517 & 0.0535 & 1380.38 \\
               -0.1979 & 0.8314 & 206.91 \\
               -0.000105 & -0.00000287 & 1.0
                \end{bmatrix}
                \]
                

            </p>
            <div class="images-row">
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9131_correspondences.jpg" alt="Correspondences Input A (Set 1)">
                    <div class="image-caption">Set 1 ‚Äî Left Correspondences Selected</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9132_correspondences.jpg" alt="Correspondences Input B (Set 1)">
                    <div class="image-caption">Set 1 ‚Äî Right Correspondences Selected</div>
                </div>
            </div>
        </div>

        <div class="question-section">
            <div class="question-header">
                <h2>A.3: Warp the Images</h2>
            </div>
            <p class="explanation">
                I implemented inverse warping with two interpolation methods: nearest neighbor and bilinear. Nearest neighbor is faster, but tends to be a little blocky, while bilinear is slower, but smoother and better for finer details.
            </p>
            <div class="images-row">
                <div class="image-container">
                    <img src="./media_proj3a/IMG_8615.jpg" alt="Rectification Pokemon Card">
                    <div class="image-caption">Pokemon Card</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/rectification_nn.png" alt="Rectification (Nearest Neighbor)">
                    <div class="image-caption">Rectification (Nearest Neighbor)</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/rectification_bilinear.png" alt="Rectification (Bilinear)">
                    <div class="image-caption">Rectification (Bilinear)</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9051.jpg" alt="Rectification Pokemon Card">
                    <div class="image-caption">Oracle Park Big Screen</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/another_rectification_nn.png" alt="Another Rectification (Nearest Neighbor)">
                    <div class="image-caption">Another Rectification (Nearest Neighbor)</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/another_rectification_bilinear.png" alt="Another Rectification (Bilinear)">
                    <div class="image-caption">Another Rectification (Bilinear)</div>
                </div>
            </div>
        </div>

        <div class="question-section">
            <div class="question-header">
                <h2>A.4: Blend the Images into a Mosaic</h2>
            </div>
            <p class="explanation">
                I first compute the bounds of the output mosaic and inverse-warp each image onto it, obtaining both the warped image and a corresponding binary mask. These masks are then converted into per-pixel feather weights using a distance transform, which creates a gradual fade near the edges (controlled by the band parameter). In overlapping regions, I blend the images using the formula (I‚ÇÅ¬∑w‚ÇÅ + I‚ÇÇ¬∑w‚ÇÇ) / (w‚ÇÅ + w‚ÇÇ) to ensure smooth transitions, while regions covered by only one image simply display that image directly in the mosaic.
            </p>
            <div class="images-row mosaic">
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9140.jpg" alt="Window Source 1">
                    <div class="image-caption">Window ‚Äî Source 1</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9141.jpg" alt="Window Source 2">
                    <div class="image-caption">Window ‚Äî Source 2</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/mosaic_comparison_window.png" alt="Mosaic - Window">
                    <div class="image-caption">Mosaic ‚Äî Window</div>
                </div>

                <div class="image-container">
                    <img src="./media_proj3a/IMG_9131.jpg" alt="Classroom Source 1">
                    <div class="image-caption">Classroom ‚Äî Source 1</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9132.jpg" alt="Classroom Source 2">
                    <div class="image-caption">Classroom ‚Äî Source 2</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/mosaic_comparison_classroom.png" alt="Mosaic - Classroom">
                    <div class="image-caption">Mosaic ‚Äî Classroom</div>
                </div>

                <div class="image-container">
                    <img src="./media_proj3a/IMG_9153.jpg" alt="Sutarjda Source 1">
                    <div class="image-caption">Sutarjda Dai ‚Äî Source 1</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/IMG_9154.jpg" alt="Sutarjda Source 2">
                    <div class="image-caption">Sutarjda Dai ‚Äî Source 2</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3a/mosaic_comparison_sutarjda.png" alt="Mosaic - Sutarjda">
                    <div class="image-caption">Mosaic ‚Äî Sutarjda Dai</div>
                </div>
            </div>  
        </div> 

        <div class="question-section">
            <div class="question-header">
                <h2>B.1: Harris Corner Detection</h2>
            </div>
            <p class="explanation">
                I implemented the Harris interest point detector for single-scale corner detection, which identifies points where there are significant changes in intensity in multiple directions, which typically correspond to corners.
                <br><br>
                I also implemented Adaptive Non-Maximal Suppression to choose the most distinctive corners while ensuring they are well-distributed across the image.
            </p>
            <div class="images-row">
                <div class="image-container">
                    <img src="./media_proj3b/harris_corners_no_anms.png" alt="Harris Corners without ANMS">
                    <div class="image-caption">Harris Corners without ANMS</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3b/harris_corners_with_anms.png" alt="Harris Corners with ANMS">
                    <div class="image-caption">Harris Corners with ANMS</div>
                </div>
            </div>
        </div>

        <div class="question-section">
            <div class="question-header">
                <h2>B.2: Feature Descriptor Extraction</h2>
            </div>
            <p class="explanation">
                I implemented the feature descriptor extraction by sampling 8x8 patches from 40x40 windows centered on each detected corner.
            </p>
            <div class="images-row">
                <div class="image-container">
                    <img src="./media_proj3b/feature_descriptors.png" alt="Feature Descriptors">
                    <div class="image-caption">Some Extracted 8x8 Feature Descriptors</div>
                </div>
            </div>
        </div>

        <div class="question-section">
            <div class="question-header">
                <h2>B.3: Feature Matching</h2>
            </div>
            <p class="explanation">
                I implemented feature matching using the ratio test approach, which helps filter out ambiguous matches where the feature could match multiple points in the second image.
            </p>
            <div class="images-row">
                <div class="image-container">
                    <img src="./media_proj3b/feature_matches.png" alt="Feature Matches">
                    <div class="image-caption">Matched Features in Classroom</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3b/feature_matches_2.png" alt="Feature Matches">
                    <div class="image-caption">Matched Features in Sutarjda Dai</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3b/feature_matches_3.png" alt="Feature Matches">
                    <div class="image-caption">Matched Features Outside</div>
                </div>
            </div>
        </div>

        <div class="question-section">
            <div class="question-header">
                <h2>B.4: RANSAC for Robust Homography</h2>
            </div>
            <p class="explanation">
                I implemented 4-point RANSAC from scratch to compute robust homography estimates. This approach effectively handles outliers in the feature matches, which are common due to false correspondences. Below are comparisons of the mosaics made by manual stitching and automatic stitching.
            </p>
            <div class="images-row mosaic">
                <div class="image-container">
                    <img src="./media_proj3b/manual_vs_automatic_mosaic_9131_9132.png" alt="Manual vs Automatic Mosaic 1">
                    <div class="image-caption">Classroom ‚Äî Manual vs Automatic Mosaic</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3b/manual_vs_automatic_mosaic_9140_9141.png" alt="Manual vs Automatic Mosaic 2">
                    <div class="image-caption">Window ‚Äî Manual vs Automatic Mosaic</div>
                </div>
                <div class="image-container">
                    <img src="./media_proj3b/manual_vs_automatic_mosaic_9153_9154.png" alt="Manual vs Automatic Mosaic 3">
                    <div class="image-caption">Sutarjda Dai ‚Äî Manual vs Automatic Mosaic</div>
                </div>
            </div>
        </div>

        <div class="back-link">
            <a href="../index.html">üè† Back to Home</a>
        </div>